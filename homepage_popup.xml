<odoo>
  <template id="assets_frontend" name="Popup Email Capture" inherit_id="website.assets_frontend" priority="50">
    <xpath expr="//body" position="inside">
      <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function () {
          if (!localStorage.getItem("popup_shown")) {
            var popup = document.createElement("div");
            popup.innerHTML = `
              <div style="position:fixed;top:20%;left:50%;transform:translateX(-50%);
                          background:#fff;padding:20px;border-radius:8px;box-shadow:0 0 10px #000;z-index:9999;">
                <h3>ðŸŽ‰ Â¡ObtÃ©n un 5% de descuento!</h3>
                <p>Introduce tu correo electrÃ³nico para recibir tu cÃ³digo exclusivo.</p>
                <input type="email" id="popup_email" placeholder="Tu correo" />
                <button onclick="enviarCorreo()">Enviar</button>
              </div>
            `;
            document.body.appendChild(popup);
            localStorage.setItem("popup_shown", "true");
          }
        });

        function enviarCorreo() {
          var email = document.getElementById("popup_email").value;
          if (email) {
            fetch("/newsletter/popup", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email: email }),
            }).then(() => {
              alert("Â¡Correo enviado! Revisa tu bandeja.");
            });
          }
        }
      </script>
    </xpath>
  </template>
</odoo>

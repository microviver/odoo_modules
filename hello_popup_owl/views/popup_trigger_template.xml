<odoo>
    <template id="hello_popup_owl_template" inherit_id="website.layout" name="Hello Popup OWL Integration">
        <xpath expr="//body" position="inside">
            <script type="module">
                <![CDATA[
                import { Component } from "@odoo/owl";
                import { registry } from "@web/core/registry";
                import { makeEnv, startService } from "@odoo/owl";
                import { services } from "@web/core/utils/services";

                async function showMyPopup() {
                    const owl_services = await startService(services);
                    const env = makeEnv({ services: owl_services });

                    const dialogService = registry.category("services").get("dialog");
                    const PopupComponent = registry.category("public_components").get("hello_popup_owl.PopupComponent");

                    if (dialogService && PopupComponent) {
                        dialogService.add(PopupComponent, {
                            title: "Oferta Especial!",
                            onClose: () => {
                                console.log("Popup fechado.");
                                sessionStorage.setItem('helloPopupShown', 'true');
                            },
                        });
                    } else {
                        console.error("Dialog service or PopupComponent not found.");
                    }
                }

                if (!sessionStorage.getItem('helloPopupShown')) {
                    showMyPopup();
                }
                ]]>
            </script>
        </xpath>
    </template>
</odoo>